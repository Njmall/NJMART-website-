<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NJ Mart â€” Your neighbourhood grocery (Full Expanded)</title>

  <!-- Google font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- ======= Styles (mobile-first, expanded) ======= -->
  <style>
    :root{
      --bg: #f5f8f7;
      --card: #ffffff;
      --accent: #2db34a;
      --accent-700: #239032;
      --muted: #6f777d;
      --danger: #e04545;
      --shadow: 0 10px 30px rgba(12,30,40,.06);
      --radius: 12px;
      --delivery-threshold: 1000;
      --delivery-charge: 20;
      --maxWidth: 980px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,-apple-system,"Segoe UI",Arial;background:var(--bg);color:#111}
    a{color:inherit}
    /* container */
    .wrap{max-width:var(--maxWidth);margin:0 auto;padding:12px}

    /* ---------- Header / Navbar ---------- */
    header.site {
      display:flex;
      align-items:center;
      gap:12px;
      justify-content:space-between;
      padding:10px 12px;
      background:var(--card);
      border-radius:12px;
      box-shadow:var(--shadow);
      margin-bottom:12px;
      position:sticky; top:8px; z-index:1000;
    }
    .brand {display:flex;align-items:center;gap:10px}
    .logo {
      width:50px;height:50px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#38c36a);
      color:#fff;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:18px;box-shadow:0 6px 18px rgba(0,0,0,.06)
    }
    .brand h1{font-size:18px;margin:0}
    .search-area{flex:1;margin-left:8px;margin-right:8px}
    .search {
      display:flex;align-items:center;gap:8px;padding:8px;border-radius:999px;background:#fff;border:1px solid #eef6ee;
    }
    .search input{border:0;outline:0;padding:8px;font-size:14px;width:100%;background:transparent}
    .nav-actions{display:flex;align-items:center;gap:8px}
    .btn {padding:8px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:700}
    .btn.ghost{background:#fff;border:1px solid #eef6ee}
    .btn.primary{background:var(--accent);color:#fff}
    .icon-btn{background:#fff;border-radius:10px;border:1px solid #eef6ee;padding:8px;cursor:pointer}

    /* ---------- Hero ---------- */
    .hero{background:linear-gradient(180deg,#1fb764,#18a84c);color:#fff;padding:22px;border-radius:14px;margin-bottom:12px;box-shadow:var(--shadow);display:flex;gap:16px;align-items:center}
    .hero .text{flex:1}
    .hero h2{margin:0 0 8px 0;font-size:20px}
    .hero p{margin:0 0 12px 0;color:rgba(255,255,255,.95)}
    .hero .cta{display:flex;gap:8px}
    .cta .btn {background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.14);color:#fff}
    .hero img{width:120px;height:120px;border-radius:12px;object-fit:cover}

    /* ---------- Sections layout ---------- */
    .section{margin:12px 0}
    .section .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
    .section .header h3{margin:0;font-size:16px}
    .section .header .more{color:var(--muted);font-size:13px}

    /* ---------- Categories ---------- */
    .categories{display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:10px}
    .cat{background:var(--card);padding:12px;border-radius:12px;text-align:center;box-shadow:0 8px 20px rgba(12,30,40,.03);cursor:pointer}
    .cat img{width:56px;height:56px;border-radius:10px;object-fit:cover;display:block;margin:0 auto 8px}

    /* ---------- Products grid ---------- */
    .products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:12px}
    .product{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 8px 20px rgba(12,30,40,.04);display:flex;flex-direction:column;gap:8px}
    .product .thumb{width:100%;height:140px;border-radius:10px;overflow:hidden;background:#f2f4f5}
    .product .thumb img{width:100%;height:100%;object-fit:cover}
    .product .title{font-weight:700;font-size:14px}
    .product .meta{font-size:13px;color:var(--muted)}
    .product .row{display:flex;justify-content:space-between;align-items:center}
    .product .price{font-weight:800;color:var(--accent)}
    .product button{border:0;padding:8px;border-radius:8px;cursor:pointer;background:var(--accent);color:#fff;font-weight:700}

    /* ---------- Suggestions carousel (horizontal) ---------- */
    .carousel{display:flex;gap:10px;overflow-x:auto;padding-bottom:6px}
    .carousel .card{min-width:140px;background:var(--card);padding:10px;border-radius:12px;box-shadow:0 8px 18px rgba(12,30,40,.03);text-align:center}

    /* ---------- Floating cart / cart panel ---------- */
    .floating-cart{
      position:fixed;right:16px;bottom:18px;background:var(--accent);color:#fff;padding:12px 16px;border-radius:999px;box-shadow:0 16px 50px rgba(16,66,20,.18);z-index:2000;cursor:pointer;display:flex;gap:10px;align-items:center;font-weight:800
    }
    .floating-cart .count{background:rgba(255,255,255,.12);padding:6px 10px;border-radius:999px}
    /* cart panel overlay */
    .cart-overlay{position:fixed;right:0;top:0;height:100vh;width:100%;display:none;align-items:flex-end;justify-content:flex-end;z-index:2500}
    .cart-overlay.open{display:flex}
    .cart-sheet{width:100%;max-width:420px;background:var(--card);height:100vh;border-radius:12px 0 0 12px;box-shadow:0 30px 70px rgba(0,0,0,.35);padding:14px;overflow:auto}
    .cart-sheet h4{margin:0 0 8px 0}
    .cart-list{display:flex;flex-direction:column;gap:10px;margin-top:8px}
    .cart-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;border:1px solid #f2f6f3}
    .cart-item img{width:72px;height:72px;border-radius:8px;object-fit:cover}
    .cart-item .info{flex:1}
    .qty-controls{display:flex;gap:6px;align-items:center}

    /* ---------- footer ---------- */
    footer.site{margin:18px 0 40px 0;text-align:center;color:var(--muted);font-size:13px}

    /* ---------- responsive tweaks ---------- */
    @media (max-width:900px){
      .hero{flex-direction:column;align-items:flex-start}
      .product .thumb{height:120px}
      header.site{flex-wrap:wrap;gap:8px}
      .search-area{order:3;width:100%}
    }
    @media (max-width:520px){
      .products-grid{grid-template-columns:repeat(2,1fr)}
      .categories{grid-template-columns:repeat(3,1fr)}
      .logo{width:44px;height:44px}
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- ================= Header ================= -->
    <header class="site" role="banner">
      <div class="brand" aria-hidden="true">
        <div class="logo">NJ</div>
        <div>
          <h1>NJ Mart</h1>
          <div style="font-size:12px;color:var(--muted)">Grocery â€¢ Home Delivery</div>
        </div>
      </div>

      <!-- Search area -->
      <div class="search-area" role="search">
        <div class="search" aria-label="Site search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" style="opacity:.7"><path d="M21 21l-4.35-4.35" stroke="#5b6b6b" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="#5b6b6b" stroke-width="1.6"/></svg>
          <input id="searchInput" placeholder="Search products, categories, brands..." aria-label="Search products">
          <button id="searchBtn" class="icon-btn" title="Search">Search</button>
        </div>
      </div>

      <!-- Right actions -->
      <div class="nav-actions" role="navigation">
        <button id="btnLogin" class="btn ghost" title="Login / Profile">Login</button>
        <div id="btnCartTop" class="icon-btn" title="Open cart">ðŸ›’ <span id="topCartCount" style="margin-left:6px;font-weight:800">0</span></div>
      </div>
    </header>

    <!-- ================= Hero ================= -->
    <section class="hero" role="region" aria-label="Get fresh groceries">
      <div class="text">
        <h2>Fresh groceries delivered to your door</h2>
        <p>Daily essentials â€¢ Fresh produce â€¢ Pantry staples â€” fast delivery and simple checkout.</p>
        <div class="cta">
          <button class="btn primary" onclick="scrollToSection('productsSection')">Start shopping</button>
          <button class="btn ghost" onclick="scrollToSection('categoriesSection')">Shop categories</button>
        </div>
      </div>
      <div>
        <img src="https://via.placeholder.com/160x160?text=Fresh" alt="Fresh groceries">
      </div>
    </section>

    <!-- ================= Categories ================= -->
    <section id="categoriesSection" class="section" aria-labelledby="categoriesHeading">
      <div class="header">
        <h3 id="categoriesHeading">Shop by category</h3>
        <div class="more"><a href="products.html">See all</a></div>
      </div>
      <div class="categories" id="categoryGrid">
        <!-- categories rendered by JS -->
      </div>
    </section>

    <!-- ================= Top Deals (example) ================= -->
    <section class="section" aria-labelledby="dealsHeading">
      <div class="header">
        <h3 id="dealsHeading">Top deals</h3>
        <div class="more small">Limited time</div>
      </div>
      <div class="products-grid" id="dealsGrid">
        <!-- deals rendered by JS -->
      </div>
    </section>

    <!-- ================= Products list ================= -->
    <section id="productsSection" class="section" aria-labelledby="productsHeading">
      <div class="header">
        <h3 id="productsHeading">Trending & Best sellers</h3>
        <div style="display:flex;gap:8px;align-items:center">
          <label class="small" for="sortSelect">Sort</label>
          <select id="sortSelect" style="padding:6px;border-radius:8px;border:1px solid #eef6ee">
            <option value="popular">Most popular</option>
            <option value="price_asc">Price â€” low to high</option>
            <option value="price_desc">Price â€” high to low</option>
          </select>
        </div>
      </div>

      <div class="products-grid" id="productGrid">
        <!-- products rendered by JS -->
      </div>
    </section>

    <!-- ================= Suggestions / Carousel ================= -->
    <section class="section" aria-labelledby="suggestHeading">
      <div class="header">
        <h3 id="suggestHeading">You might also like</h3>
        <div class="more small">Personalized picks</div>
      </div>
      <div class="carousel" id="suggestions">
        <!-- suggestion cards by JS -->
      </div>
    </section>

    <!-- ================= Footer ================= -->
    <footer class="site">
      <div class="small">Â© 2025 NJ Mart â€” demo. For production, integrate Firebase and payment gateway.</div>
    </footer>

  </div> <!-- /wrap -->

  <!-- ================= Floating Cart Button ================= -->
  <div id="floatingCart" class="floating-cart" role="button" aria-label="Open cart">
    <div>ðŸ›’</div>
    <div>
      <div style="font-size:13px">Cart</div>
      <div style="font-size:14px" id="floatingTotal">â‚¹0</div>
    </div>
    <div class="count" id="floatingCount">0</div>
  </div>

  <!-- ================= Cart Overlay (slide panel) ================= -->
  <div id="cartOverlay" class="cart-overlay" aria-hidden="true">
    <div class="cart-sheet" role="dialog" aria-label="Your cart">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h4>Your cart</h4>
        <div>
          <button id="closeCart" class="btn ghost">Close</button>
        </div>
      </div>

      <div id="cartList" class="cart-list" style="margin-top:12px">
        <!-- cart items inserted here -->
      </div>

      <div style="margin-top:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="small">Items total</div><div id="cartSubtotal">â‚¹0</div>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
          <div class="small">Delivery</div><div id="cartDelivery">â‚¹0</div>
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
          <div class="small">Discount</div><div id="cartDiscount">â‚¹0</div>
        </div>
        <hr style="margin:10px 0;border:none;border-top:1px dashed #eee">
        <div style="display:flex;justify-content:space-between;align-items:center;font-weight:800">
          <div>Total</div><div id="cartGrand">â‚¹0</div>
        </div>

        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="checkoutBtn" class="btn primary" style="flex:1">Checkout</button>
          <button id="clearCartBtn" class="btn ghost" style="flex:1">Clear</button>
        </div>

        <div style="margin-top:10px" class="small">Orders below â‚¹1000 carry â‚¹20 delivery. Coupons can be applied at checkout.</div>
      </div>
    </div>
  </div>

  <!-- ================= JS: functionality (expanded) ================= -->
  <script>
    /* =========================
       NJ MART â€” index.html main script
       - Full expanded front-end that stores cart & profile in localStorage
       - Keys:
         nj_cart      -> cart array [{id,name,price,qty,img,category}]
         nj_user      -> profile {name,phone,address,email}
         nj_coupon    -> applied coupon object
         nj_checkout  -> snapshot before redirect to checkout.html
    ========================= */

    /* ---------- Configuration & demo data (you can replace these with real data) ---------- */
    const DELIVERY_THRESHOLD = 1000; // free delivery if subtotal >= 1000
    const DELIVERY_CHARGE = 20; // â‚¹20 if below threshold

    // A larger list of real-feel demo products (you can replace images & details)
    const ALL_PRODUCTS = [
      { id:'p001', name:'Fresh Tomatoes (1kg)', price:40, img:'https://via.placeholder.com/400x300?text=Tomato', category:'Vegetables', popular: 98 },
      { id:'p002', name:'Milk â€” 1L (Toned)', price:55, img:'https://via.placeholder.com/400x300?text=Milk', category:'Dairy', popular: 120 },
      { id:'p003', name:'Potatoes (1kg)', price:25, img:'https://via.placeholder.com/400x300?text=Potato', category:'Vegetables', popular: 75 },
      { id:'p004', name:'Onions (1kg)', price:30, img:'https://via.placeholder.com/400x300?text=Onion', category:'Vegetables', popular: 89 },
      { id:'p005', name:'Aashirvaad Atta (5kg)', price:394, img:'https://via.placeholder.com/400x300?text=Atta', category:'Grocery', popular: 60 },
      { id:'p006', name:'Laxmi Refined Oil (1L)', price:208, img:'https://via.placeholder.com/400x300?text=Oil', category:'Grocery', popular: 45 },
      { id:'p007', name:'Tata Salt (1kg)', price:29, img:'https://via.placeholder.com/400x300?text=Salt', category:'Grocery', popular: 140 },
      { id:'p008', name:'Maggi Noodles (2-min)', price:12, img:'https://via.placeholder.com/400x300?text=Maggi', category:'Snacks', popular: 200 },
      { id:'p009', name:'Amul Paneer (500g)', price:180, img:'https://via.placeholder.com/400x300?text=Paneer', category:'Dairy', popular: 75 },
      { id:'p010', name:'Apple (1kg)', price:160, img:'https://via.placeholder.com/400x300?text=Apple', category:'Fruits', popular: 55 },
      { id:'p011', name:'Banana (1 dozen)', price:55, img:'https://via.placeholder.com/400x300?text=Banana', category:'Fruits', popular: 130 },
      { id:'p012', name:'Brown Bread (400g)', price:45, img:'https://via.placeholder.com/400x300?text=Bread', category:'Bakery', popular: 40 }
    ];

    const CATEGORIES = ['Vegetables','Fruits','Dairy','Snacks','Beverages','Grocery','Bakery','Household'];

    // Demo coupons (admin can change by setting localStorage 'nj_settings')
    const DEFAULT_COUPONS = [
      { code:'SAVE50', type:'FLAT', value:50, description:'Flat â‚¹50 off' },
      { code:'FREEDEL', type:'DELIVERY', value:DELIVERY_CHARGE, description:'Free delivery' },
      { code:'PERC10', type:'PERCENT', value:10, description:'10% off' }
    ];

    /* ---------- localStorage helpers ---------- */
    function load(key){ try{ return JSON.parse(localStorage.getItem(key)); }catch(e){ return null; } }
    function save(key, val){ localStorage.setItem(key, JSON.stringify(val)); }
    function remove(key){ localStorage.removeItem(key); }

    /* ---------- cart helpers ---------- */
    function loadCart(){ return load('nj_cart') || []; }
    function saveCart(cart){ save('nj_cart', cart); updateFloatingCart(); }
    function clearCart(){ remove('nj_cart'); renderCartPanel(); updateFloatingCart(); }

    /* ---------- profile helpers ---------- */
    function getProfile(){ return load('nj_user') || null; }

    /* ---------- coupon helpers ---------- */
    function findCoupon(code){
      if(!code) return null;
      code = code.trim().toUpperCase();
      const settings = load('nj_settings') || {};
      const adminCoupons = (settings.coupons || []).concat(DEFAULT_COUPONS);
      return adminCoupons.find(c => (c.code || '').toUpperCase() === code) || null;
    }

    /* ---------- UI selectors ---------- */
    const categoryGrid = document.getElementById('categoryGrid');
    const dealsGrid = document.getElementById('dealsGrid');
    const productGrid = document.getElementById('productGrid');
    const suggestionsEl = document.getElementById('suggestions');

    const floatingCart = document.getElementById('floatingCart');
    const floatingCount = document.getElementById('floatingCount');
    const floatingTotal = document.getElementById('floatingTotal');
    const topCartCount = document.getElementById('topCartCount');

    const cartOverlay = document.getElementById('cartOverlay');
    const cartListEl = document.getElementById('cartList');
    const cartSubtotalEl = document.getElementById('cartSubtotal');
    const cartDeliveryEl = document.getElementById('cartDelivery');
    const cartDiscountEl = document.getElementById('cartDiscount');
    const cartGrandEl = document.getElementById('cartGrand');

    const btnCartTop = document.getElementById('btnCartTop');
    const btnLogin = document.getElementById('btnLogin');
    const closeCartBtn = document.getElementById('closeCart');
    const checkoutBtn = document.getElementById('checkoutBtn');
    const clearCartBtn = document.getElementById('clearCartBtn');

    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const sortSelect = document.getElementById('sortSelect');

    /* ---------- Initialization: render categories, products, suggestions ---------- */
    function init(){
      renderCategories();
      renderTopDeals();
      renderProducts(ALL_PRODUCTS);
      renderSuggestions();
      attachEventHandlers();
      updateFloatingCart();
    }

    function renderCategories(){
      categoryGrid.innerHTML = '';
      CATEGORIES.forEach(cat=>{
        const node = document.createElement('div');
        node.className = 'cat';
        node.innerHTML = `<img src="https://via.placeholder.com/80?text=${encodeURIComponent(cat[0])}" alt="${cat}"><div style="font-weight:700;margin-top:6px">${cat}</div>`;
        node.addEventListener('click', ()=> filterByCategory(cat));
        categoryGrid.appendChild(node);
      });
    }

    function renderTopDeals(){
      dealsGrid.innerHTML = '';
      // show first 4 high-popular products as deals
      const deals = ALL_PRODUCTS.slice().sort((a,b)=>b.popular-a.popular).slice(0,4);
      deals.forEach(p => {
        const node = document.createElement('div');
        node.className = 'product';
        node.innerHTML = `
          <div class="thumb"><img src="${p.img}" alt="${p.name}"></div>
          <div>
            <div class="title">${p.name}</div>
            <div class="meta small">${p.category}</div>
            <div style="margin-top:8px" class="row">
              <div class="price">â‚¹${p.price}
