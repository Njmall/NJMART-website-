<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>NJ Mart — Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--green:#2db34a;--muted:#7b7f86;--card:#fff;--bg:#f3faf6;--danger:#e04d4d}
  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,sans-serif}
  body{margin:0;background:var(--bg);color:#111}
  .wrap{max-width:920px;margin:24px auto;padding:16px;display:grid;grid-template-columns:1fr 360px;gap:18px}
  @media(max-width:980px){.wrap{grid-template-columns:1fr;padding:12px}}
  .card{background:var(--card);border-radius:12px;box-shadow:0 10px 30px rgba(12,30,40,.06);padding:16px}
  h1{margin:0 0 8px}
  .small{color:var(--muted);font-size:13px}
  input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e7eef0;margin-top:8px;font-size:14px}
  .btn{border:0;border-radius:10px;padding:12px;font-weight:700;cursor:pointer}
  .btn.primary{background:var(--green);color:white;width:100%}
  .btn.ghost{background:#fff;border:1px solid #e6eaec;color:#333;width:100%}
  .row{display:flex;gap:12px}
  .meta{font-size:13px;color:var(--muted);margin-top:8px}
  .link{color:var(--green);cursor:pointer;text-decoration:underline}
</style>
</head>
<body>
  <div class="wrap">
    <main class="card">
      <h1>My Profile</h1>
      <div class="small">Update your name, phone, address and delivery location</div>

      <div style="margin-top:14px">
        <label class="small">Name</label>
        <input id="name" type="text" placeholder="Your full name">
      </div>

      <div style="margin-top:12px">
        <label class="small">Phone (with country code)</label>
        <input id="phone" type="tel" placeholder="+91 9876543210">
      </div>

      <div style="margin-top:12px">
        <label class="small">Address</label>
        <textarea id="address" rows="4" placeholder="House, street, area"></textarea>
      </div>

      <div style="display:flex;gap:10px;margin-top:12px">
        <button id="getLocation" class="btn ghost" style="flex:1">Get Current Location</button>
        <button id="saveProfile" class="btn primary" style="flex:1">Save Profile</button>
      </div>

      <div class="meta" style="margin-top:10px">Latitude: <span id="lat">—</span> Longitude: <span id="lng">—</span></div>

      <div style="margin-top:16px;display:flex;gap:10px">
        <button id="goHome" class="btn ghost" style="flex:1">Back to Shop</button>
        <button id="goCart" class="btn ghost" style="flex:1">Go to Cart</button>
      </div>

      <div class="meta" style="margin-top:10px">Profile data is stored locally on this device (demo).</div>
    </main>

    <aside class="card">
      <h2 style="margin:0">Profile Preview</h2>
      <div class="small" style="margin-top:8px">Your saved details appear here</div>

      <div style="margin-top:12px">
        <div><strong>Name:</strong> <span id="p_name">—</span></div>
        <div style="margin-top:6px"><strong>Phone:</strong> <span id="p_phone">—</span></div>
        <div style="margin-top:6px"><strong>Address:</strong> <div id="p_address" style="margin-top:6px">—</div></div>
        <div style="margin-top:6px" class="small">Lat: <span id="p_lat">—</span> • Lng: <span id="p_lng">—</span></div>
      </div>

      <hr style="margin:12px 0;border:none;border-top:1px solid #f1f3f4">

      <div style="display:flex;flex-direction:column;gap:8px">
        <button id="clearProfile" class="btn ghost">Clear Profile</button>
        <button id="ordersBtn" class="btn primary">My Orders</button>
      </div>
    </aside>
  </div>

<script>
  // Profile page logic — stores to localStorage key 'nj_profile'
  const elName = document.getElementById('name');
  const elPhone = document.getElementById('phone');
  const elAddress = document.getElementById('address');
  const elLat = document.getElementById('lat');
  const elLng = document.getElementById('lng');

  const pName = document.getElementById('p_name');
  const pPhone = document.getElementById('p_phone');
  const pAddress = document.getElementById('p_address');
  const pLat = document.getElementById('p_lat');
  const pLng = document.getElementById('p_lng');

  function loadProfile(){
    const saved = JSON.parse(localStorage.getItem('nj_profile') || '{}');
    elName.value = saved.name || '';
    elPhone.value = saved.phone || '';
    elAddress.value = saved.address || '';
    elLat.innerText = saved.lat || '—';
    elLng.innerText = saved.lng || '—';

    pName.innerText = saved.name || '—';
    pPhone.innerText = saved.phone || '—';
    pAddress.innerText = saved.address || '—';
    pLat.innerText = saved.lat || '—';
    pLng.innerText = saved.lng || '—';
  }

  document.getElementById('saveProfile').addEventListener('click', ()=>{
    const data = {
      name: elName.value.trim(),
      phone: elPhone.value.trim(),
      address: elAddress.value.trim(),
      lat: elLat.innerText === '—' ? '' : elLat.innerText,
      lng: elLng.innerText === '—' ? '' : elLng.innerText,
      savedAt: Date.now()
    };
    localStorage.setItem('nj_profile', JSON.stringify(data));
    loadProfile();
    alert('Profile saved locally');
  });

  document.getElementById('getLocation').addEventListener('click', ()=>{
    if(!navigator.geolocation){ alert('Geolocation not supported'); return; }
    const btn = document.getElementById('getLocation');
    btn.innerText = 'Getting...';
    navigator.geolocation.getCurrentPosition(pos=>{
      const lat = pos.coords.latitude.toFixed(7);
      const lng = pos.coords.longitude.toFixed(7);
      elLat.innerText = lat; elLng.innerText = lng;
      btn.innerText = 'Get Current Location';
    }, err=>{
      alert('Unable to get location: ' + (err.message||err));
      btn.innerText = 'Get Current Location';
    }, {enableHighAccuracy:true, timeout:10000});
  });

  document.getElementById('clearProfile').addEventListener('click', ()=>{
    if(!confirm('Clear saved profile data?')) return;
    localStorage.removeItem('nj_profile');
    loadProfile();
  });

  document.getElementById('goHome').addEventListener('click', ()=> location.href='index.html');
  document.getElementById('goCart').addEventListener('click', ()=> location.href='cart.html');
  document.getElementById('ordersBtn').addEventListener('click', ()=> location.href='orders.html');

  // load on start
  loadProfile();
</script>
</body>
</html>
